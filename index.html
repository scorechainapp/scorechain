<script>
  // Formatear dirección de wallet (ej: 0x1234...abcd)
  function formatAddress(address) {
    return address.slice(0, 6) + "..." + address.slice(-4);
  }

  // Año actual
  document.getElementById("year").textContent = new Date().getFullYear();

  // Cambio de idioma
  document.getElementById('lang-selector')?.addEventListener('change', (e) => {
    const lang = e.target.value;
    document.querySelectorAll('[data-es]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
  });

  // Conectar Wallet con formato
  async function connectWallet() {
    if (window.ethereum) {
      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const wallet = accounts[0];
        document.getElementById("walletAddress").textContent = 
          `Wallet conectada: ${formatAddress(wallet)}`;
      } catch (error) {
        console.error(error);
      }
    } else {
      alert('MetaMask no detectado');
    }
  }
  document.getElementById("connect-wallet").addEventListener("click", connectWallet);

  // Cambiar a Base Network con formato
  document.getElementById("switch-base").addEventListener("click", async () => {
    if (window.ethereum) {
      try {
        await window.ethereum.request({
          method: 'wallet_switchEthereumChain',
          params: [{ chainId: '0x2105' }]
        });
        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
        if (accounts.length > 0) {
          document.getElementById("walletAddress").textContent = 
            `Wallet conectada: ${formatAddress(accounts[0])}`;
        }
        alert("Conectado a Base Network");
      } catch (error) {
        console.error(error);
      }
    }
  });

  // Cargar datos de CoinGecko
  async function loadCryptoData() {
    try {
      const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana,usd-coin,binancecoin&vs_currencies=usd");
      const data = await res.json();
      document.getElementById("btc-price").textContent = `$${data.bitcoin.usd}`;
      document.getElementById("eth-price").textContent = `$${data.ethereum.usd}`;
      document.getElementById("sol-price").textContent = `$${data.solana.usd}`;
      document.getElementById("usdc-price").textContent = `$${data["usd-coin"].usd}`;
      document.getElementById("bnb-price").textContent = `$${data.binancecoin.usd}`;
    } catch (error) {
      console.error("Error al cargar datos de CoinGecko:", error);
    }
  }
  loadCryptoData();
  setInterval(loadCryptoData, 60000);
</script>
